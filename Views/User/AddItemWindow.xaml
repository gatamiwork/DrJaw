<Window x:Class="DrJaw.Views.User.AddItemWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Добавить позицию"
        Height="560" Width="900"
        MinHeight="480" MinWidth="820"
        WindowStartupLocation="CenterOwner"
        xmlns:helpers="clr-namespace:DrJaw.Helpers"
        ResizeMode="CanResize">

    <Grid Margin="16">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320"/>
            <ColumnDefinition Width="16"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ЛЕВАЯ ПАНЕЛЬ: превью изображения -->
        <Border Grid.Row="0" Grid.Column="0"
                CornerRadius="8"
                Padding="8">
            <Viewbox Stretch="Uniform">
                <Grid Width="280" Height="280">
                    <Border CornerRadius="6" />
                    <Image Stretch="Uniform"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           SnapsToDevicePixels="True"
                           RenderOptions.BitmapScalingMode="HighQuality"
                           Source="{Binding PreviewImage}"/>
                    <TextBlock Text="Нет изображения"
           Foreground="#888"
           FontSize="16"
           HorizontalAlignment="Center"
           VerticalAlignment="Center">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <!-- показываем текст, когда PreviewImage == null -->
                                    <DataTrigger Binding="{Binding PreviewImage}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>
            </Viewbox>
        </Border>
        <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal" Margin="0,8,0,0">
            <Button Content="Выбрать…" Command="{Binding PickImageCommand}" IsEnabled="{Binding CanEditImage}"/>
            <Button Content="Очистить" Command="{Binding ClearImageCommand}" Margin="8,0,0,0" IsEnabled="{Binding CanEditImage}"/>
        </StackPanel>

        <!-- ПРАВАЯ ПАНЕЛЬ: форма -->
        <Grid Grid.Row="0" Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Articul -->
                <RowDefinition Height="Auto"/>
                <!-- Type -->
                <RowDefinition Height="Auto"/>
                <!-- Metal -->
                <RowDefinition Height="Auto"/>
                <!-- Weight -->
                <RowDefinition Height="Auto"/>
                <!-- Size -->
                <RowDefinition Height="Auto"/>
                <!-- Stone -->
                <RowDefinition Height="Auto"/>
                <!-- Manufacturer -->
                <RowDefinition Height="Auto"/>
                <!-- Price -->
                <RowDefinition Height="*"/>
                <!-- Comment -->
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="150"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Row="0" Grid.Column="0" Text="Артикул:"      VerticalAlignment="Center" Margin="0,0,12,8"/>
            <TextBox  Grid.Row="0" Grid.Column="1" Margin="0,0,0,8" Text="{Binding Articul, UpdateSourceTrigger=PropertyChanged}"
                      materialDesign:TextFieldAssist.HasClearButton="True"/>

            <TextBlock Grid.Row="1" Grid.Column="0" Text="Тип:"          VerticalAlignment="Center" Margin="0,0,12,8"/>
            <ComboBox Grid.Row="1" Grid.Column="1" Margin="0,0,0,8"
                ItemsSource="{Binding Types}"
                SelectedItem="{Binding SelectedType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                DisplayMemberPath="Name"
                      IsEnabled="{Binding IsTypeMetalEnabled}"/>

            <TextBlock Grid.Row="2" Grid.Column="0" Text="Металл:"       VerticalAlignment="Center" Margin="0,0,12,8"/>
            <ComboBox Grid.Row="2" Grid.Column="1" ItemsSource="{Binding Metals}" IsEnabled="{Binding IsTypeMetalEnabled}"
                      SelectedItem="{Binding SelectedMetal, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                      DisplayMemberPath="Name"/>

            <TextBlock Grid.Row="3" Grid.Column="0" Text="Вес:"          VerticalAlignment="Center" Margin="0,0,12,8"/>
            <TextBox  Grid.Row="3" Grid.Column="1" Margin="0,0,0,8"     
                      helpers:NumericInput.DecimalOnly="True"
                      helpers:NumericInput.MaxDecimalPlaces="3"
                      Text="{Binding Weight, UpdateSourceTrigger=PropertyChanged}"/>

            <TextBlock Grid.Row="4" Grid.Column="0" Text="Размер:"       VerticalAlignment="Center" Margin="0,0,12,8"/>
            <TextBox  Grid.Row="4" Grid.Column="1" Margin="0,0,0,8"
                      helpers:NumericInput.DecimalOnly="True"
                      helpers:NumericInput.MaxDecimalPlaces="3"
                      Text="{Binding Size, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBlock Grid.Row="5" Grid.Column="0" Text="Вставки:"      VerticalAlignment="Center" Margin="0,0,12,8"/>
            <ComboBox Grid.Row="5" Grid.Column="1" Margin="0,0,0,8"
                        ItemsSource="{Binding Stones}"
                        SelectedItem="{Binding SelectedStone, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        DisplayMemberPath="Name"
                      ScrollViewer.CanContentScroll="True"/>

            <TextBlock Grid.Row="6" Grid.Column="0" Text="Производитель:" VerticalAlignment="Center" Margin="0,0,12,8"/>
            <ComboBox Grid.Row="6" Grid.Column="1" Margin="0,0,0,8"
                    ItemsSource="{Binding Manufacturers}"
                    SelectedItem="{Binding SelectedManufacturer, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    DisplayMemberPath="Name"
                      ScrollViewer.CanContentScroll="True"/>

            <TextBlock Grid.Row="7" Grid.Column="0" Text="Цена:"         VerticalAlignment="Center" Margin="0,0,12,8"/>
            <TextBox  Grid.Row="7" Grid.Column="1" Margin="0,0,0,8"
                      helpers:NumericInput.DecimalOnly="True"
                      helpers:NumericInput.MaxDecimalPlaces="3"
                      Text="{Binding Price, UpdateSourceTrigger=PropertyChanged}"/>

            <TextBlock Grid.Row="8" Grid.Column="0" Text="Комментарий:"  VerticalAlignment="Top"    Margin="0,2,12,0"/>
            <Border Grid.Row="8" Grid.Column="1" Background="{DynamicResource MaterialDesignPaper}" CornerRadius="6">
                <TextBox Text="{Binding Comment, UpdateSourceTrigger=PropertyChanged}"
                         AcceptsReturn="True"
                         TextWrapping="Wrap"
                         BorderThickness="0"
                         Padding="8"
                         VerticalScrollBarVisibility="Auto"/>
            </Border>
        </Grid>

        <!-- НИЖНЯЯ ПАНЕЛЬ КНОПОК -->
        <StackPanel Grid.Row="1" Grid.Column="2"
            Orientation="Horizontal"
            HorizontalAlignment="Right"
            Margin="0,12,0,0">
            <Button x:Name="ActionButton"
            Content="Добавить"
            Height="36" MinWidth="140"
            Margin="0,0,8,0"
            IsDefault="True"
            Command="{Binding SaveCommand}"
            materialDesign:ButtonAssist.CornerRadius="8"/>

            <Button Content="Закрыть"
            Height="36" MinWidth="120"
            IsCancel="True"
            Command="{Binding CancelCommand}"
            materialDesign:ButtonAssist.CornerRadius="8"/>
        </StackPanel>
    </Grid>
</Window>

<Window x:Class="DrJaw.Views.Common.MSSQLConSet"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Доктор ювелирка" Height="350" Width="550"
        materialDesign:ColorZoneAssist.Mode="PrimaryDark" WindowStartupLocation="CenterScreen">

    <Window.InputBindings>
        <KeyBinding Key="Enter" Command="{Binding ConnectCommand}"/>
        <KeyBinding Key="Escape" Command="{Binding CancelCommand}"/>
    </Window.InputBindings>

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    </Window.Resources>
        <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Настройки подключения MSSQL"
                   FontSize="18" FontWeight="SemiBold" HorizontalAlignment="Center"/>
        <!-- Поля блокируются во время подключения -->
        <Grid Grid.Row="1" IsEnabled="{Binding IsNotBusy}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="Сервер:"/>
            <TextBox   Grid.Row="0" Grid.Column="1" Text="{Binding Server, UpdateSourceTrigger=PropertyChanged}" />

            <TextBlock Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Text="База данных:"/>
            <TextBox   Grid.Row="1" Grid.Column="1" Text="{Binding Database, UpdateSourceTrigger=PropertyChanged}" />

            <TextBlock Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Text="Пользователь:"/>
            <TextBox   Grid.Row="2" Grid.Column="1" Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}" />

            <TextBlock Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Text="Пароль:"/>
            <PasswordBox x:Name="PasswordBox"
                         Grid.Row="3" Grid.Column="1"
                         PasswordChanged="PasswordBox_PasswordChanged"/>
        </Grid>
        <ProgressBar Grid.Row="2" IsIndeterminate="True"
                         Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}"/>

            <!-- ОДНА кнопка: по умолчанию "Подключить", во время работы — "Отмена" -->
        <Button Grid.Row="3">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Content" Value="Подключить"/>
                        <Setter Property="Command" Value="{Binding ConnectCommand}"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsBusy}" Value="True">
                                <Setter Property="Content" Value="Отмена"/>
                                <Setter Property="Command" Value="{Binding CancelCommand}"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>

        <materialDesign:Snackbar
            Grid.Row="2"
            MessageQueue="{Binding SnackbarQueue}"
            HorizontalAlignment="Stretch"
            IsHitTestVisible="False"
            Margin="0" />
    </Grid>
</Window>
